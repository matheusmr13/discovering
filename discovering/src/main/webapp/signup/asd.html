<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!--	<link rel="stylesheet" href="/css/initial-page.css" type="text/css">-->
	<link rel="stylesheet" type="text/css" href="/css/demo.css" />
	<link rel="stylesheet" type="text/css" href="/css/set1.css" />
	<link rel="stylesheet" type="text/css" href="/css/normalize.css" />
	<link rel="stylesheet" type="text/css" href="/css/initial-page.css" />
</head>

<body class="pattern">
	<div class="content">
		<a href="/">
			<div class="header custom-font font-3 default-color">
				<img src="/img/icon.png" class="header-logo"> Discovering
			</div>
		</a>
		<div class="login-wrapper form-control" style="display:none; ">
			<div class="container">
				<section class="content bgcolor-6">
					<h1>Register now!</h1>
					<span class="input input--juro">
					<input class="input__field input__field--juro" type="text" id="input-28" />
					<label class="input__label input__label--juro" for="input-28">
						<span class="input__label-content input__label-content--juro">Login</span>
					</label>
					</span>
					<span class="input input--juro">
					<input class="input__field input__field--juro" type="password" id="input-29" />
					<label class="input__label input__label--juro" for="input-29">
						<span class="input__label-content input__label-content--juro">Password</span>
					</label>
					</span>
					<div class="buttons text-center">
						<a id="login" class="btn green">Login</a>
					</div>
					<hr/>
					<div class="buttons text-center">
						<a id="google-login" class="btn blue">Login with Google</a>
					</div>
				</section>
			</div>
		</div>
	</div>

	<script type="text/javascript " src="/js/lib/jquery-2.1.4.js " charset="utf-8 "></script>
	<script type="text/javascript " src="/js/lib/toastr.js " charset="utf-8 "></script>
	<script>
		$(document).ready(function () {
			$.getJSON('/discovering/api/usuarios/me').done(function (me) {
				window.location = ['COMISSAO', 'FORMANDO'].indexOf(me.perfil) !== -1 ? '/formando/' : '/turing';
			}).fail(function () {
				$('.login-wrapper').show();

				$('#google-login').click(function () {
					$.ajax({
						type: 'GET',
						url: '/authEmail/loginUrl'
					}).done(function (url) {
						window.location = url;
					});

					return false;
				});

				$('input[name="login "], input[name="password "]').keypress(function (e) {
					if (e.keyCode === 13) {
						$('#login').click();
					}
				});

				$('#login').click(function () {
					$.ajax({
						type: 'PUT',
						url: '/discovering/auth',
						data: {
							email: $('#email-login').val(),
							senha: $('#password-login').val()
						}
					}).done(function () {
						window.location = '/formando';
					}).fail(function (e) {
						toastr.error(e.responseText);
						$('[name=email]').focus();
					});
				});

				if (window.location.hash === '#email-invalido') {
					toastr.error('Acesso negado para essa conta de e-mail');
					window.location.hash = '';
				}
			});
		});
	</script>

	<script src="/js/lib/classie.js"></script>
	<script>
		(function () {
			// trim polyfill : https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/Trim
			if (!String.prototype.trim) {
				(function () {
					// Make sure we trim BOM and NBSP
					var rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;
					String.prototype.trim = function () {
						return this.replace(rtrim, '');
					};
				})();
			}

				[].slice.call(document.querySelectorAll('input.input__field')).forEach(function (inputEl) {
				// in case the input is already filled..
				if (inputEl.value.trim() !== '') {
					classie.add(inputEl.parentNode, 'input--filled');
				}

				// events:
				inputEl.addEventListener('focus', onInputFocus);
				inputEl.addEventListener('blur', onInputBlur);
			});

			function onInputFocus(ev) {
				classie.add(ev.target.parentNode, 'input--filled');
			}

			function onInputBlur(ev) {
				if (ev.target.value.trim() === '') {
					classie.remove(ev.target.parentNode, 'input--filled');
				}
			}
		})();
	</script>
</body>

</html>